
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>什么是HashMap? | 杨阳的博客</title>
<meta name="description" content="记录下">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://yangyng.github.io/favicon.ico?v=1561625868789">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://yangyng.github.io/styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://yangyng.github.io">
        <img class="avatar" src="https://yangyng.github.io/images/avatar.png?v=1561625868789" alt="" width="32px" height="32px">
      </a>
      <a href="https://yangyng.github.io">
        <h1 class="site-title">杨阳的博客</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/" class="menu purple-link">
            首页
          </a>
        
      
        
          <a href="/archives" class="menu purple-link">
            归档
          </a>
        
      
        
          <a href="/tags" class="menu purple-link">
            标签
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            关于
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
            <div class="feature-container" style="background-image: url('https://yangyng.github.io/post-images/RZblMP02A.jpg')">
            </div>
          
          <h2 class="post-title">什么是HashMap?</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2019-06-18</span>
            
          </div>
          <div class="post-content">
            <h4 id="什么是hashmap">什么是HashMap</h4>
<p>hashMap 是一个用于存储KEY-VALUE键值对的集合,每一个键值对也叫作Entry.这些个键值对(Entry)分散存储在一个数组中.</p>
<p><img src="https://yangyng.github.io/post-images/1560845187679.png" alt=""></p>
<p>HashMap 的初始值大小为 16</p>
<p>HashMap中我们最常用到的两个方法: <strong>GET</strong> <strong>PUT</strong></p>
<h6 id="put方法的原理"><strong>PUT</strong>方法的原理</h6>
<p>首先 调用<strong>PUT</strong>方法时 都发生了什么?</p>
<blockquote>
<ol>
<li>
<p>hash(key)  使用该hash函数来确定呢Entry的插入位置</p>
<p>首先 HashMap的长度是有限的</p>
<p>那么 当插入的Entry越来越多时,使用hash(key)函数计算出来的hash值就必定会存在相同的情况</p>
</li>
<li>
<p>对于相同的hash值 该怎么办? (<strong>hash冲突</strong>) =&gt; <strong>链表</strong></p>
<p>HashMap 数组的每一个元素不止是一个Entry对象,也是一个链表的头节点.每一个Entry对象通过Next指针指向它的下一个Entry节点.当新来的Entry映射到冲突的数组位置时,只需要插入到对应的链表即可.</p>
<p><img src="https://yangyng.github.io/post-images/1560845208688.png" alt=""></p>
<p>**注意: **新来的Entry节点插入链表时,使用的是&quot;头插法&quot;,即最新的元素放在链表的头部. <strong>因为HashMap的发明者认为,后插入的Entry被查找的可能性更大</strong></p>
</li>
</ol>
</blockquote>
<pre><code>//以下部分为 hashMap中的源码
public V put(K key, V value) {
        return putVal(hash(key), key, value, false, true);
}
//putVal 方法
final V putVal(int hash, K key, V value, boolean onlyIfAbsent,
                   boolean evict) {
        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i;
        if ((tab = table) == null || (n = tab.length) == 0)
            n = (tab = resize()).length;
        if ((p = tab[i = (n - 1) &amp; hash]) == null)
            tab[i] = newNode(hash, key, value, null);
        else {
            Node&lt;K,V&gt; e; K k;
            if (p.hash == hash &amp;&amp;
                ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))
                e = p;
            else if (p instanceof TreeNode)
                e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);
            else {
                for (int binCount = 0; ; ++binCount) {
                    if ((e = p.next) == null) {
                        p.next = newNode(hash, key, value, null);
                        if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st
                            treeifyBin(tab, hash);
                        break;
                    }
                    if (e.hash == hash &amp;&amp;
                        ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))
                        break;
                    p = e;
                }
            }
            if (e != null) { // existing mapping for key
                V oldValue = e.value;
                if (!onlyIfAbsent || oldValue == null)
                    e.value = value;
                afterNodeAccess(e);
                return oldValue;
            }
        }
        ++modCount;
        if (++size &gt; threshold)
            resize();
        afterNodeInsertion(evict);
        return null;
    }
</code></pre>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://yangyng.github.io/post/UzPIBHidO">
              <h3 class="post-title">
                下一篇：分布式锁及其实现方式
              </h3>
            </a>
          </div>
          
      </div>

      

      <div class="site-footer">
  <div class="slogan">记录下</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://yangyng.github.io/atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
